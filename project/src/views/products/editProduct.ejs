<!DOCTYPE html>
<html lang="en">

<%- include('../partials/head') %>

	<body>
		<%- include('../partials/header') %>
			<main class="container">
				<div class="product-form">
					<h1>Editar producto</h1>
					<form action="/products/edit/<%= product.product_id %>?_method=PUT" method="POST"
						enctype="multipart/form-data" id="mainForm">
						<input type="hidden" name="type" value="isProduct">
						<% if (locals.errors && errors.image) { %>
							<input  class="product-form__image controlar" type="file" placeholder="Imagen" name="image" id="image">
							<div class="error"><%= errors.image.msg %></div>
						<% } else { %>
							<input class="product-form__image controlar" type="file" placeholder="Imagen" name="image" id="image">
							<span></span>
						<% } %>
						<% if (!oldData.name) { %>
							<% if (locals.errors && errors.name) { %>
								<input class="controlar"  type="text" placeholder="Nombre del producto" name="name" value="<%= oldData.name %>" id="name">
								<div class="error"><%= errors.name.msg %></div>			
							<% } else { %>
								<input class="controlar" type="text" placeholder="Nombre del producto" name="name" value="<%= product.name %>" id="name">
								<span></span>
							<% } %>
						<% } else { %>
							<% if (locals.errors && errors.name) { %>
								<input class="controlar"  type="text" placeholder="Nombre del producto" name="name" value="<%= oldData.name %>" id="name">
								<div class="error"><%= errors.name.msg %></div>
							<% } else { %>
								<input class="controlar" type="text" placeholder="Nombre del producto" name="name" value="<%= oldData.name %>" id="name">
								<span></span>
							<% } %>
						<% } %>
						<% if (!oldData.price) { %>
							<% if (locals.errors && errors.price) { %>
								<input class="controlar"  type="text" placeholder="Precio" name="price" value="<%= oldData.price %>" id="price">
								<div class="error"><%= errors.price.msg %></div>
							<% } else { %>
								<input class="controlar" type="text" placeholder="Precio" name="price" value="<%= product.price %>" id="price">
								<span></span>
							<% } %>
						<% } else { %>
							<% if (locals.errors && errors.price) { %>
								<input class="controlar"  type="text" placeholder="Precio" name="price" value="<%= oldData.price %>" id="price">
								<div class="error"><%= errors.price.msg %></div>
							<% } else { %>
								<input class="controlar" type="text" placeholder="Precio" name="price" value="<%= oldData.price %>" id="price">
								<span></span>
							<% } %>
						<% } %>
						<% if (!oldData.discount) { %>
							<% if (locals.errors && errors.discount) { %>
								<input class="controlar"  type="text" placeholder="Descuento" name="discount" value="<%= oldData.discount %>" id="discount">
								<div class="error"><%= errors.discount.msg %></div>
							<% } else { %>
								<input class="controlar" type="text" placeholder="Descuento" name="discount" value="<%= product.discount %>" id="discount">
								<span></span>
							<% } %>
						<% } else { %>
							<% if (locals.errors && errors.discount) { %>
								<input class="controlar"  type="text" placeholder="Descuento" name="discount" value="<%=  oldData.discount %>" id="discount">
								<div class="error"><%= errors.discount.msg %></div>
							<% } else { %>
								<input class="controlar" type="text" placeholder="Descuento" name="discount" value="<%=  oldData.discount %>" id="discount">
								<span></span>
							<% } %>
						<% } %>
						<% if (!oldData.descriptionTitle) { %>
							<% if (locals.errors && errors.descriptionTitle) { %>
								<input class="controlar"  type="text" placeholder="Título de la descripción" name="descriptionTitle" value="<%= oldData.descriptionTitle %>" id="descriptionTitle">
								<div class="error"><%= errors.descriptionTitle.msg %></div>
							<% } else { %>
								<input class="controlar" type="text" placeholder="Título de la descripción" name="descriptionTitle" value="<%= product.description_title %>" id="descriptionTitle">
								<span></span>
							<% } %>
						<% } else { %>
							<% if (locals.errors && errors.descriptionTitle) { %>
								<input class="controlar"  type="text" placeholder="Título de la descripción" name="descriptionTitle" value="<%= oldData.descriptionTitle %>" id="descriptionTitle">
								<div class="error"><%= errors.descriptionTitle.msg %></div>
							<% } else { %>
								<input class="controlar" type="text" placeholder="Título de la descripción" name="descriptionTitle" value="<%= oldData.descriptionTitle %>" id="descriptionTitle">
								<span></span>
							<% } %>
						<% } %>
						<% if (!oldData.description) { %>
							<% if (locals.errors && errors.description) { %>
								<textarea  class="controlar"  placeholder="Descripción" name="description" id="description"><%= oldData.description %></textarea>
								<div class="error"><%= errors.description.msg %></div>
							<% } else { %>
								<textarea class="controlar" placeholder="Descripción" name="description" id="description"><%= product.description %></textarea>
								<span></span>
							<% } %>
						<% } else { %>
							<% if (locals.errors && errors.description) { %>
								<textarea  class="controlar"  placeholder="Descripción" name="description" id="description"><%= oldData.description %></textarea>
								<div class="error"><%= errors.description.msg %></div>
							<% } else { %>
								<textarea class="controlar" placeholder="Descripción" name="description" id="description"><%= oldData.description %></textarea>
								<span></span>
							<% } %>
						<% } %>
						<% if (!oldData.stock) { %>
							<% if (locals.errors && errors.stock) { %>
								<input class="controlar"  type="text" placeholder="Stock" name="stock" value="<%= oldData.stock %>" id="stock">
								<div class="error"><%= errors.stock.msg %></div>
							<% } else { %>
								<input class="controlar" type="text" placeholder="Stock" name="stock" value="<%= product.stock %>" id="stock">
								<span></span>
							<% } %>
						<% } else { %>
							<% if (locals.errors && errors.stock) { %>
								<input class="controlar"  type="text" placeholder="Stock" name="stock" value="<%= oldData.stock %>" id="stock">
								<div class="error"><%= errors.stock.msg %></div>
							<% } else { %>
								<input class="controlar" type="text" placeholder="Stock" name="stock" value="<%= oldData.stock %>" id="stock" >
								<span></span>
							<% } %>
						<% } %>
						<% if (!oldData.specs) { %>
							<% if (locals.errors && errors.specs) { %>
								<textarea class="controlar"  placeholder="Características del producto" name="specs" id="specs"><%= oldData.specs %></textarea>
								<div class="error"><%= errors.specs.msg %></div>
							<% } else { %>
								<textarea class="controlar" placeholder="Características del producto" name="specs" id="specs"><%= product.specs %></textarea>
								<span></span>
							<% } %>
						<% } else { %>
							<% if (locals.errors && errors.specs) { %>
								<textarea class="controlar"  placeholder="Características del producto" name="specs" id="specs"><%= oldData.specs %></textarea>
								<div class="error"><%= errors.specs.msg %></div>
							<% } else { %>
								<textarea class="controlar" placeholder="Características del producto" name="specs" id="specs"><%= oldData.specs %></textarea>
								<span></span>
							<% } %>
						<% } %>
						<% if (!oldData.category) { %>
							<% if (locals.errors && errors.category) { %>
								<select  class="controlar" name="category" id="category" >
									<option value="">Elegí una categoría:</option>
									<% for(const oneCategory of productCategories) { %>
										<option value="<%= oneCategory.category_id %>" <%= (oneCategory.category_id == oldData.category) ? 'selected' : null %>> <%= oneCategory.name %> </option>
									<% } %>
								</select>
								<div class="error"><%= errors.category.msg %></div>
							<% } else { %>
								<select class="controlar" name="category" id="category" >
									<option value="">Elegí una categoría:</option>
									<% for(const oneCategory of productCategories) { %>
										<option value="<%= oneCategory.category_id %>" <%= (oneCategory.category_id == product.category_id) ? 'selected' : null %>> <%= oneCategory.name %> </option>
									<% } %>
								</select>
								<span></span>
							<% } %>
						<% } else { %>
							<% if (locals.errors && errors.category) { %>
								<select  class="controlar" name="category" id="category" >
									<option value="">Elegí una categoría:</option>
									<% for(const oneCategory of productCategories) { %>
										<option value="<%= oneCategory.category_id %>" <%= (oneCategory.category_id == oldData.category) ? 'selected' : null %>> <%= oneCategory.name %> </option>
									<% } %>
								</select>
								<div class="error"><%= errors.category.msg %></div>
							<% } else { %>
								<select class="controlar" name="category" id="category" >
									<option value="">Elegí una categoría:</option>
									<% for(const oneCategory of productCategories) { %>
										<option value="<%= oneCategory.category_id %>" <%= (oneCategory.category_id == oldData.category) ? 'selected' : null %>> <%= oneCategory.name %> </option>
									<% } %>
								</select>
								<span></span>
							<% } %>
						<% } %>
						<% if (!oldData.brand) { %>
							<% if (locals.errors && errors.brand) { %>
								<select  class="controlar" name="brand" id="brand" >
									<option value="">Elegí una marca:</option>
									<% for(const oneBrand of productBrands) { %>
										<option value="<%= oneBrand.brand_id %>" <%= (oneBrand.brand_id == oldData.brand) ? 'selected' : null %>> <%= oneBrand.name %> </option>
									<% } %>
								</select>
								<div class="error"><%= errors.brand.msg %></div>
							<% } else { %>
								<select class="controlar" name="brand" id="brand" >
									<option value="">Elegí una marca:</option>
									<% for(const oneBrand of productBrands) { %>
										<option value="<%= oneBrand.brand_id %>" <%= (oneBrand.brand_id == product.brand_id) ? 'selected' : null %>> <%= oneBrand.name %> </option>
									<% } %>
								</select>
								<span></span>
							<% } %>
						<% } else { %>
							<% if (locals.errors && errors.brand) { %>
								<select  class="controlar" name="brand" id="brand" >
									<option value="">Elegí una marca:</option>
									<% for(const oneBrand of productBrands) { %>
										<option value="<%= oneBrand.brand_id %>" <%= (oneBrand.brand_id == oldData.brand) ? 'selected' : null %>> <%= oneBrand.name %> </option>
									<% } %>
								</select>
								<div class="error"><%= errors.brand.msg %></div>
							<% } else { %>
								<select class="controlar" name="brand" id="brand" >
									<option value="">Elegí una marca:</option>
									<% for(const oneBrand of productBrands) { %>
										<option value="<%= oneBrand.brand_id %>" <%= (oneBrand.brand_id == oldData.brand) ? 'selected' : null %>> <%= oneBrand.name %> </option>
									<% } %>
								</select>
								<span></span>
							<% } %>
						<% } %>
						<% if (!oldData.color) { %>
							<% if (locals.errors && errors.color) { %>
								<select class="controlar" name="color" id="color" >
									<option value="">Elegí un color:</option>
									<% for(let i = 0; i < productColors.length; i++) {%>
										<% for(let j = 0; j < productColors[i].products.length; j++) {%>
											<% if (product.product_id === productColors[i].products[j].product_id) { %>
												<option value="<%= productColors[i].color_id %>" selected><%= productColors[i].name %></option>
											<% } %>
										<% } %>
										<option value="<%= productColors[i].color_id %>"> <%= productColors[i].name %> </option>
									<% } %>
								</select>
								<div class="error"><%= errors.color.msg %></div>
							<% } else {%>
								<select class="controlar" name="color" id="color" >
									<option value="">Elegí un color:</option>
									<% for(let i = 0; i < productColors.length; i++) {%>
										<% for(let j = 0; j < productColors[i].products.length; j++) {%>
											<% if (product.product_id === productColors[i].products[j].product_id) { %>
												<option value="<%= productColors[i].color_id %>" selected><%= productColors[i].name %></option>
											<% } %>
										<% } %>
										<option value="<%= productColors[i].color_id %>"> <%= productColors[i].name %> </option>
									<% } %>
								</select>
							<% } %>					
						<% } else { %>
							<% if (locals.errors && errors.color) { %>
								<select  class="controlar" name="color" id="color" >
									<option value="">Elegí un color:</option>
									<% for(const oneColor of productColors) { %>
										<option value="<%= oneColor.color_id %>" <%= (oneColor.color_id == oldData.color) ? 'selected' : null %>> <%= oneColor.name %> </option>
									<% } %>
								</select>
								<div class="error"><%= errors.color.msg %></div>
							<% } else { %>
								<select class="controlar" name="color" id="color" >
									<option value="">Elegí un color:</option>
									<% for(const oneColor of productColors) { %>
										<option value="<%= oneColor.color_id %>" <%= (oneColor.color_id == oldData.color) ? 'selected' : null %>> <%= oneColor.name %> </option>
									<% } %>
								</select>
							<% } %>
						<% } %>
						<!-- <input class="product-form__image" type="file" placeholder="Imagen" name="image" >
						<input type="number" placeholder="Precio" name="price" value="<%= product.price %>" >
						<input type="number" placeholder="Descuento" name="discount" value="<%= product.discount %>" >
						<input type="text" placeholder="Título de la descripción" name="descriptionTitle" value="<%= product.description_title %>" >
						<textarea placeholder="Descripción" name="description" ><%= product.description %></textarea>
						<input type="number" placeholder="Stock" name="stock" value="<%= product.stock %>" >
						<textarea placeholder="Características del producto" name="specs" ><%= product.specs %></textarea>
						<select class="controlar" name="category" id="category">
							<option value="">Elegí una categoría:</option>
							<% for(const oneCategory of productCategories) { %>
								<% if (oneCategory.category_id === product.category_id) { %>
									<option value="<%= oneCategory.category_id%>" selected><%= oneCategory.name %></option>
								<% } %>
								<option value="<%= oneCategory.category_id %>"><%= oneCategory.name %></option>
							<% } %>
						</select>
						<select class="controlar" name="brand" id="brand">
							<option value="">Elegí una marca:</option>
							<% for(const oneBrand of productBrands) { %>
								<% if (oneBrand.brand_id === product.brand_id) { %>
									<option value="<%= oneBrand.brand_id %>" selected><%= oneBrand.name %></option>
								<% } %>
								<option value="<%= oneBrand.brand_id %>"><%= oneBrand.name %></option>
							<% } %>
						</select>
						<select class="controlar" name="color" id="color" >
							<option value="">Elegí un color:</option>
							<% for(let i = 0; i < productColors.length; i++) {%>
								<% for(let j = 0; j < productColors[i].products.length; j++) {%>
									<% if (product.product_id === productColors[i].products[j].product_id) { %>
										<option value="<%= productColors[i].color_id %>" selected><%= productColors[i].name %></option>
									<% } %>
								<% } %>
								<option value="<%= productColors[i].color_id %>"> <%= productColors[i].name %> </option>
							<% } %>
						</select> -->
						<button type="submit" class="product-form__button">Confirmar</button>
					</form>
				</div>
			</main>
			<%- include('../partials/footer') %>
			<script src="https://unpkg.com/validator@latest/validator.min.js"></script>
    		<script type="text/javascript" src="/js/validationProduct.js"></script>
	</body>

</html>